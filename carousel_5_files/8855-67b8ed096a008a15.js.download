"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8855],{59578:function(e,t,n){n.d(t,{Z:function(){return j}});var a=n(47568),s=n(70655),i=n(85893),l=n(67294),r=n(11355),o=n(69737),c=n(10124),d=n(11163),m=n(33303),u=n(9198),h=n.n(u),x=n(14441),f=(n(39828),n(60728)),v=n(30120),p=n(65082),y=n(80360),g=n(52077);function j(e){var t=e.idInvoice,n=e.open,u=e.setOpen,j=(0,l.useState)(new Date),b=j[0],N=j[1],w=(0,l.useState)(!1),k=w[0],C=w[1],F=(0,l.useState)((0,m.tl)("invoice-payment-methods")),Z=F[0],S=F[1],T=(0,l.useState)(null),_=T[0],I=T[1],M=(0,d.useRouter)(),V=(0,p.Z)(),E=V.get,D=V.post,A=(0,f.Z)(),O=A.confirm,P=A.ConfirmDialog,R=function(){var e=(0,a.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return C(!0),[4,D("invoice/pay",{idInvoice:t,date:b,paymentMethod:null===_||void 0===_?void 0:_.id}).catch(console.log)];case 1:return(e=n.sent())&&!0===e.status?m.Z9.success("Invoice marked as paid!"):m.Z9.error(e.message),u(!1),M.reload(),C(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=(0,a.Z)((function(){var e,t,n;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return[4,E("invoice/get-payment-methods").catch(console.log)];case 1:return(e=a.sent())&&!0===e.status&&e.content&&(n=null===(t=e.content.filter((function(e){return e.active})))||void 0===t?void 0:t.map((function(e){return{name:e.name,id:e.code}})),(0,m.Fs)("invoice-payment-methods",n),S(n)),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){n?Y():I(null)}),[n]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.u.Root,{show:n,as:l.Fragment,children:(0,i.jsx)(o.V,{as:"div",className:"fixed z-100 inset-0 overflow-y-auto",onClose:u,static:k,children:(0,i.jsxs)("div",{className:"flex items-end lg:items-center justify-center min-h-screen lg:pt-4 lg:px-4 lg:pb-20 text-center sm:block sm:p-0",children:[(0,i.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,i.jsx)(o.V.Overlay,{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-2xs transition-opacity"})}),(0,i.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,i.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,i.jsxs)("div",{className:"inline-block align-bottom w-full bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-visible shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-sm sm:p-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:(0,i.jsx)(c.Z,{className:"h-6 w-6 text-green-600","aria-hidden":"true"})}),(0,i.jsxs)("div",{className:"mt-3 sm:mt-5",children:[(0,i.jsx)(o.V.Title,{as:"h3",className:"text-lg text-center leading-6 font-medium text-gray-900",children:"Mark invoice as paid"}),(0,i.jsx)("div",{className:"mt-8",children:(0,i.jsxs)("div",{className:"flex flex-col w-full",children:[(0,i.jsx)("label",{className:"mb-1",children:"Payment date"}),(0,i.jsx)(h(),{className:"w-full flex-1",selected:b,onChange:function(e){return N(e)},dateFormat:"MMM dd, yyyy",calendarClassName:"tailwind-calendar",customInput:(0,i.jsx)(x.Z,{}),portalId:"root-portal"})]})}),(0,i.jsx)("div",{className:"mt-8",children:(0,i.jsx)(y.Z,{label:"Payment method",placeholder:"Select",values:Z,value:_,onChange:I})})]})]}),(0,i.jsx)("div",{className:"mt-5 sm:mt-6",children:(0,i.jsx)(g.Z,{type:"button",className:"primary w-full",onClick:function(){return O("Are you sure?","You are going to mark this invoice as paid on ".concat(v.ou.fromJSDate(b).toFormat("DD")," and it can't be reverted."),(function(){return R()}),null)},loading:k,children:"Mark as paid"})})]})}),(0,i.jsx)(P,{confirmText:"Mark as paid"}),(0,i.jsx)("div",{id:"root-portal"})]})})})})}},12015:function(e,t,n){n.d(t,{Z:function(){return h}});var a=n(47568),s=n(70655),i=n(85893),l=n(67294),r=n(11355),o=n(69737),c=(n(16494),n(65082)),d=n(30112),m=n(33303),u=n(52077);function h(e){var t=e.invoice,n=e.open,h=e.setOpen,x=e.onClose,f=(0,l.useState)(!1),v=f[0],p=f[1],y=(0,l.useState)(null),g=y[0],j=y[1],b=(0,l.useState)(""),N=b[0],w=b[1],k=(0,c.Z)(),C=(k.get,k.post),F=(0,l.useState)(!1),Z=F[0],S=F[1],T=function(){var e=(0,a.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return p(!0),S(!1),[4,C("/invoice/send-to-customer",{idInvoice:t._id}).catch(console.log)];case 1:return 429===(null===(e=n.sent())||void 0===e?void 0:e.code)&&S(!0),e&&!0===e.status?j(!0):j(!1),p(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),_=function(){"function"===typeof x&&x(g),h(!1)};(0,l.useEffect)((function(){n&&j(null)}),[n]),(0,l.useEffect)((function(){var e,n;t&&(t.customer||t.Customer)&&w((null===(e=t.customer)||void 0===e?void 0:e.email)||(null===(n=t.Customer)||void 0===n?void 0:n.email))}),[t]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.u.Root,{show:n,as:l.Fragment,children:(0,i.jsx)(o.V,{as:"div",className:"fixed z-100 inset-0 overflow-y-auto",onClose:_,static:v,children:(0,i.jsxs)("div",{className:"flex items-end lg:items-center justify-center min-h-screen lg:pt-4 lg:px-4 lg:pb-20 text-center sm:block sm:p-0",children:[(0,i.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,i.jsx)(o.V.Overlay,{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-2xs transition-opacity"})}),(0,i.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,i.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,i.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-visible shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-sm sm:w-full",children:null===g?(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("div",{className:"mx-auto mb-2 flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100",children:(0,i.jsx)(d.Z,{icon:"ExclamationIcon",className:"h-6 w-6 text-indigo-600","aria-hidden":"true"})}),(0,i.jsxs)(o.V.Title,{as:"h3",className:"text-lg text-center leading-6 font-medium text-gray-900",children:["Would you like to send this invoice to ",N,"?"]}),(0,i.jsxs)("div",{className:"flex gap-4 mt-5 sm:mt-6",children:[(0,i.jsx)("button",{type:"button",className:"secondary w-full",onClick:function(){return h(!1)},disabled:v,children:"Cancel"}),(0,i.jsx)(u.Z,{type:"button",className:"primary w-full",onClick:function(){return T()},loading:v,children:"Send Invoice"})]})]}):(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("div",{className:(0,m.AK)(g?"bg-green-100":"bg-red-100","mx-auto mb-2 flex items-center justify-center h-12 w-12 rounded-full"),children:(0,i.jsx)(d.Z,{icon:g?"CheckIcon":"XIcon",className:(0,m.AK)(g?"text-green-600":"text-red-600","h-6 w-6"),"aria-hidden":"true"})}),(0,i.jsx)(o.V.Title,{as:"h3",className:"text-lg text-center leading-6 font-medium text-gray-900",children:Z?"You are sending too many invoices. Please, try again later.":g?"Awesome! You just sent an invoice to ".concat(N,"!"):"Something went wrong! Please, try to send the invoice again."}),(0,i.jsx)("div",{className:"text-center mt-5 sm:mt-6",children:(0,i.jsx)("button",{type:"button",className:"primary",onClick:function(){return _()},children:"Close"})})]})})})]})})})})}}}]);