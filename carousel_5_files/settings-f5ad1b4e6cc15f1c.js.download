(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6614],{79755:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-business/settings",function(){return i(97231)}])},67568:function(e,n,i){"use strict";i.d(n,{S:function(){return r},Z:function(){return c}});var s=i(10253),a=i(85893),t=i(86067),o=i(33303),l=i(11355),d=i(67294);function r(e){var n=e.children,i=e.text,s=e.dirty;return(0,a.jsx)(l.u,{as:d.Fragment,show:s,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsxs)("div",{className:"sticky bottom-0 z-50 flex items-center justify-between gap-3 p-4 sm:px-6 bg-white border-t border-gray-100 lg:rounded-b-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:null!==i&&void 0!==i?i:"Save changes?"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:n})]})})}function c(e){var n=e.children,i=e.dirty,l=(0,s.Z)((0,t.Z)("layout.sidebarOpen"),2),d=l[0];l[1];return(0,a.jsx)("div",{className:(0,o.AK)(i?"bottom-0 opacity-100":"-bottom-80 opacity-0","fixed left-0 right-0 z-90 lg:z-50 max-w-screen-3xl md:px-6 bg-gray-50 transition-all duration-300",d?"md:left-[15.5rem]":"md:left-24"),children:(0,a.jsx)("div",{className:"flex items-center justify-between gap-3 py-4 px-6 md:px-0 border-t border-gray-300",children:n})})}},97231:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return I}});var s=i(47568),a=i(26042),t=i(69396),o=i(10253),l=i(51351),d=i(29815),r=i(70655),c=i(85893),u=i(33303),m=i(67294),f=i(16494),v=i(51121),h=i(80360),Z=i(65082),p=i(30112),y=i(30120),N=i(41664),b=i.n(N),x=i(33299),g=i(67568),j=i(86067),C=i(52077),w=i(53371),S=i(11215),A=i(11163),M={us:[{id:"",name:"Select"},{id:"AL",name:"Alabama (AL)"},{id:"AK",name:"Alaska (AK)"},{id:"AZ",name:"Arizona (AZ)"},{id:"AR",name:"Arkansas (AR)"},{id:"CA",name:"California (CA)"},{id:"CO",name:"Colorado (CO)"},{id:"CT",name:"Connecticut (CT)"},{id:"DE",name:"Delaware (DE)"},{id:"DC",name:"District Of Columbia (DC)"},{id:"FL",name:"Florida (FL)"},{id:"GA",name:"Georgia (GA)"},{id:"HI",name:"Hawaii (HI)"},{id:"ID",name:"Idaho (ID)"},{id:"IL",name:"Illinois (IL)"},{id:"IN",name:"Indiana (IN)"},{id:"IA",name:"Iowa (IA)"},{id:"KS",name:"Kansas (KS)"},{id:"KY",name:"Kentucky (KY)"},{id:"LA",name:"Louisiana (LA)"},{id:"ME",name:"Maine (ME)"},{id:"MD",name:"Maryland (MD)"},{id:"MA",name:"Massachusetts (MA)"},{id:"MI",name:"Michigan (MI)"},{id:"MN",name:"Minnesota (MN)"},{id:"MS",name:"Mississippi (MS)"},{id:"MO",name:"Missouri (MO)"},{id:"MT",name:"Montana (MT)"},{id:"NE",name:"Nebraska (NE)"},{id:"NV",name:"Nevada (NV)"},{id:"NH",name:"New Hampshire (NH)"},{id:"NJ",name:"New Jersey (NJ)"},{id:"NM",name:"New Mexico (NM)"},{id:"NY",name:"New York (NY)"},{id:"NC",name:"North Carolina (NC)"},{id:"ND",name:"North Dakota (ND)"},{id:"OH",name:"Ohio (OH)"},{id:"OK",name:"Oklahoma (OK)"},{id:"OR",name:"Oregon (OR)"},{id:"PA",name:"Pennsylvania (PA)"},{id:"RI",name:"Rhode Island (RI)"},{id:"SC",name:"South Carolina (SC)"},{id:"SD",name:"South Dakota (SD)"},{id:"TN",name:"Tennessee (TN)"},{id:"TX",name:"Texas (TX)"},{id:"UT",name:"Utah (UT)"},{id:"VT",name:"Vermont"},{id:"VA",name:"Virginia"},{id:"WA",name:"Washington"},{id:"WV",name:"West Virginia"},{id:"WI",name:"Wisconsin"},{id:"WY",name:"Wyoming"},{id:"AS",name:"American Samoa (AS)"},{id:"GU",name:"Guam (GU)"},{id:"MP",name:"Northern Mariana Islands (MP)"},{id:"PR",name:"Puerto Rico (PR)"},{id:"UM",name:"United States Minor Outlying Islands (UM)"},{id:"VI",name:"Virgin Islands (VI)"}],ca:[{id:"",name:"Select"},{id:"AB",name:"Alberta (AB)"},{id:"BC",name:"British Columbia (BC)"},{id:"MB",name:"Manitoba (MB)"},{id:"NB",name:"New Brunswick (NB)"},{id:"NL",name:"Newfoundland and Labrador (NL)"},{id:"NS",name:"Nova Scotia (NS)"},{id:"ON",name:"Ontario (ON)"},{id:"PE",name:"Prince Edward Island (PE)"},{id:"QC",name:"Quebec (QC)"},{id:"SK",name:"Saskatchewan (SK)"},{id:"NT",name:"Northwest Territories (NT)"},{id:"NU",name:"Nunavut (NU)"},{id:"YT",name:"Yukon (YT)"}]};function I(e){e=null!==e?e:(0,l.Z)(new TypeError("Cannot destructure undefined"));var n,i,N,I,T,O,k,_,L,E,D,P,B,F,K,V,R,U,Y,W,H,G,J,z,X,Q=(0,o.Z)((0,j.Z)("layout.title","Business",!0),2),$=(Q[0],Q[1],(0,m.useState)([])),q=$[0],ee=$[1],ne=(0,m.useState)(!1),ie=ne[0],se=ne[1],ae=(0,m.useState)(!0),te=ae[0],oe=ae[1],le=(0,m.useState)((0,u.tl)("business.config")),de=le[0],re=le[1],ce=(0,m.useState)(!1),ue=ce[0],me=ce[1],fe=(0,m.useState)(null),ve=fe[0],he=fe[1],Ze=(0,u.ac)("(max-width: 767px)"),pe=(0,A.useRouter)(),ye=(0,x.useSession)().data,Ne=(0,Z.Z)(),be=Ne.get,xe=Ne.post,ge=(0,m.useState)(!1),je=ge[0],Ce=ge[1],we=(0,m.useState)({id:-1,name:""}),Se=we[0],Ae=we[1],Me=(0,S.Z)().reloadBusinesses;(0,m.useEffect)((function(){var e;if((null===q||void 0===q?void 0:q.length)>0&&(null===de||void 0===de||null===(e=de.business)||void 0===e?void 0:e.type)){var n,i,s,o,l,d,r,c,u,m,f,v=q.find((function(e){var n,i,s,a,t;return e.id===(null===(n=de.business)||void 0===n||null===(i=n.type)||void 0===i||null===(s=i.Type)||void 0===s?void 0:s._id)||e.id===(null===(a=de.business)||void 0===a||null===(t=a.type)||void 0===t?void 0:t.Type)}));Ae((0,t.Z)((0,a.Z)({},null!==(f=null===de||void 0===de||null===(n=de.business)||void 0===n?void 0:n.type)&&void 0!==f?f:{}),{id:(null===(i=de.business)||void 0===i||null===(s=i.type)||void 0===s||null===(o=s.Type)||void 0===o?void 0:o._id)||(null===(l=de.business)||void 0===l||null===(d=l.type)||void 0===d?void 0:d.Type),name:"Custom"===(null===(r=de.business)||void 0===r||null===(c=r.type)||void 0===c?void 0:c.name)?v.name:null===(u=de.business)||void 0===u||null===(m=u.type)||void 0===m?void 0:m.name}))}}),[q,null===de||void 0===de||null===(n=de.business)||void 0===n?void 0:n.type]);var Ie,Te=function(){var e=(0,s.Z)((function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return se(!0),[4,be("/business/get-config")];case 1:return(e=n.sent())&&!0===e.status&&e.content?(he((0,u.p$)(e.content)),(0,u.Fs)("business.config",e.content),re(e.content),e.content.business.name):re(null),se(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,s.Z)((function(){var e,n,i,s;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return[4,be("/business/get-business-types").catch(console.log)];case 1:return e=o.sent(),n=[],e&&((i=n).push.apply(i,(0,d.Z)(e.content.map((function(e){var n=e._id;return delete e._id,(0,t.Z)((0,a.Z)({},e),{id:n})})))),s=n.find((function(e){return"Other"===e.name})),(n=n.filter((function(e){return e.id!==s.id}))).push(s)),ee(n),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,s.Z)((function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return oe(!0),se(!0),de.business.name?[3,1]:(oe(!1),se(!1),[3,6]);case 1:return[4,xe("/business/save",de).catch(console.log)];case 2:return(e=n.sent())&&!0===e.status?[4,Me()]:[3,4];case 3:return n.sent(),u.Z9.success("Settings saved!"),he((0,u.p$)(de)),(0,u.Fs)("business.config",de),[3,5];case 4:u.Z9.error(e.message),n.label=5;case 5:se(!1),n.label=6;case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,m.useEffect)((function(){de&&ve&&(JSON.stringify(ve)===JSON.stringify(de)?me(!1):me(!0))}),[de,ve]),(0,m.useEffect)((function(){var e;if(de&&q&&(null===pe||void 0===pe||null===(e=pe.query)||void 0===e?void 0:e.scroll)){var n,i=document.getElementById(null===pe||void 0===pe||null===(n=pe.query)||void 0===n?void 0:n.scroll);i&&(i.scrollIntoView({behavior:"smooth"}),pe.push("/my-business/settings",void 0,{shallow:!0}))}}),[pe,de,q]),(0,m.useEffect)((function(){Te(),Oe()}),[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(w.Z,{context:"sync_email",open:je,setOpen:Ce}),(0,c.jsxs)("div",{className:"flex flex-col gap-5 max-w-3xl mx-auto",children:[(!de||!(null===q||void 0===q?void 0:q.length))&&(0,c.jsx)(f.Z,{variant:"form",className:"mb-4"}),de&&(null===q||void 0===q?void 0:q.length)>0&&de.business&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(g.Z,{dirty:ue,children:[(0,c.jsx)("p",{className:"text-sm font-medium",children:"Unsaved"}),(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("button",{className:"secondary",disabled:ie,onClick:function(){return function(){var e=(0,u.p$)(ve);re(e),e.business.name,me(!1)}()},children:"Discard"}),(0,c.jsx)(C.Z,{className:"primary",onClick:function(){return ke()},loading:ie,children:"Save"})]})]}),(0,c.jsxs)("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow",children:[(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsx)("h5",{className:"mb-1",children:"Details"}),(0,c.jsx)("p",{className:"text-gray-500",children:"Business name, industry, contacts and address."})]}),(0,c.jsx)(v.Z,{label:"Name",name:"name",type:"text",value:de.business.name,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{business:(0,t.Z)((0,a.Z)({},de.business),{name:e})}))},error:te||de.business.name?"":"You must provide a Business name"}),(0,c.jsx)("div",{className:"flex-1 mt-4",children:(0,c.jsx)(h.Z,{values:q,label:"Industry",autocomplete:!0,showSuggestions:!0,allowUnlistedValues:!0,icon:"SearchIcon",value:Se,className:"w-full",placeholder:"Please select your industry",onChange:function(e){if(e.name){var n=null;if("string"===typeof e.id){var i,s,o;n=(0,t.Z)((0,a.Z)({},de.business.type),{name:e.name,Type:(0,t.Z)((0,a.Z)({},null!==(o=null===de||void 0===de||null===(i=de.business)||void 0===i||null===(s=i.type)||void 0===s?void 0:s.Type)&&void 0!==o?o:{}),{_id:e.id,name:e.name})})}else{var l,d,r,c=q.find((function(e){return"Other"===e.name}));n=(0,t.Z)((0,a.Z)({},de.business.type),{name:e.name,Type:(0,t.Z)((0,a.Z)({},null!==(r=null===de||void 0===de||null===(l=de.business)||void 0===l||null===(d=l.type)||void 0===d?void 0:d.Type)&&void 0!==r?r:{}),{_id:c.id,name:"Other"})})}re((0,t.Z)((0,a.Z)({},de),{business:(0,t.Z)((0,a.Z)({},de.business),{type:n})}))}},showNoResults:!1,showSelectorIcon:!1,error:te||(null===(i=de.business)||void 0===i||null===(N=i.type)||void 0===N?void 0:N.name)?"":"Please select a business type",showTypingAsOption:!0})}),(0,c.jsx)("hr",{}),(0,c.jsx)("label",{className:"lg mb-4",children:"Contact"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,c.jsx)(v.Z,{label:"First Name",name:"firstName",value:null===(I=de.office.contact)||void 0===I?void 0:I.firstName,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{contact:(0,t.Z)((0,a.Z)({},de.office.contact),{firstName:e})})}))}}),(0,c.jsx)(v.Z,{label:"Last Name",name:"lastName",value:null===(T=de.office.contact)||void 0===T?void 0:T.lastName,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{contact:(0,t.Z)((0,a.Z)({},de.office.contact),{lastName:e})})}))}})]}),(0,c.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4 items-end",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"mb-1",children:"Phone number"}),(0,c.jsx)(v.Z,{value:de.office.phoneNumber||"",onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{phoneNumber:e})}))}})]})}),(0,c.jsx)("hr",{}),(0,c.jsx)("label",{className:"lg mb-4",children:"Business email"}),(0,c.jsx)("div",{className:"grid grid-cols-1 xl:grid-cols-2 my-4 gap-4 items-end",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(v.Z,{readOnly:!!(null===de||void 0===de||null===(O=de.business)||void 0===O||null===(k=O.nylas)||void 0===k?void 0:k.token),className:"mb-4",label:"Email",error:de.office.email&&!(0,u.oH)(de.office.email)?"You must provide a valid email":"",name:"email",type:"email",value:de.office.email,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{email:e})}))}}),(null===de||void 0===de||null===(_=de.business)||void 0===_||null===(L=_.nylas)||void 0===L?void 0:L.token)&&(0,c.jsx)("div",{className:"rounded-md bg-green-50 py-2 px-4 mb-2",children:(0,c.jsxs)("div",{className:"flex md:items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)(p.Z,{icon:"CheckIcon",className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),(0,c.jsx)("div",{className:"ml-3 flex-1 md:flex md:justify-between md:items-center",children:(0,c.jsxs)("p",{className:"text-sm text-green-700",children:["Email connected via ",(0,c.jsx)("span",{className:"font-medium uppercase",children:null===de||void 0===de||null===(E=de.business)||void 0===E||null===(D=E.nylas)||void 0===D?void 0:D.provider}),(null===de||void 0===de||null===(P=de.business)||void 0===P||null===(B=P.nylas)||void 0===B?void 0:B.connectedAt)?" on "+y.ou.fromISO(null===de||void 0===de||null===(F=de.business)||void 0===F||null===(K=F.nylas)||void 0===K?void 0:K.connectedAt).toFormat("DD"):"","!"]})})]})}),(null===ye||void 0===ye||null===(V=ye.user)||void 0===V||null===(R=V.plan)||void 0===R||null===(U=R.features)||void 0===U?void 0:U.includes("sync_email"))?(0,c.jsx)(b(),{href:"/crm/settings",children:(0,c.jsxs)("a",{className:"button link flex items-center mt-2",children:[(0,c.jsx)(p.Z,{icon:"MailIcon",className:"h-5 w-5 mr-1"})," ",(null===de||void 0===de||null===(Y=de.business)||void 0===Y||null===(W=Y.nylas)||void 0===W?void 0:W.token)?"Manage your connected email":"Connect your email"]})}):(0,c.jsxs)(C.Z,{onClick:function(e){Ce(!0)},className:"button link flex items-center mt-2",children:[(0,c.jsx)(p.Z,{icon:"MailIcon",className:"h-5 w-5 mr-1"})," Connect your email"]})]})}),(0,c.jsx)("hr",{}),(0,c.jsxs)("div",{id:"address",className:"scroll-offset",children:[(0,c.jsx)("label",{className:"lg mb-4",children:"Address"}),(0,c.jsx)(v.Z,{name:"line1",type:"text",placeholder:"Address line 1",className:"mb-4",value:de.office.address.line1,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{line1:e})})}))}}),(0,c.jsx)(v.Z,{name:"line2",type:"text",placeholder:"Address line 2",value:de.office.address.line2,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{line2:e})})}))}}),(0,c.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,c.jsx)(h.Z,{className:"w-full",inline:Ze,value:u.hW.find((function(e){var n,i;return e.code.toLowerCase()===(null!==(Ie=de.office.address.country.toLowerCase())&&void 0!==Ie?Ie:null===ye||void 0===ye||null===(n=ye.user)||void 0===n||null===(i=n.location)||void 0===i?void 0:i.toLowerCase())})),onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{country:e.code})})}))},values:u.hW,label:"Country",hasFilter:!0,disabled:"none"!==(null===ye||void 0===ye||null===(H=ye.user)||void 0===H?void 0:H.stripeOnboardingStatus)}),"us"===(null===de||void 0===de||null===(G=de.office)||void 0===G||null===(J=G.address)||void 0===J?void 0:J.country.toLowerCase())||"ca"===(null===de||void 0===de||null===(z=de.office)||void 0===z||null===(X=z.address)||void 0===X?void 0:X.country.toLowerCase())?(0,c.jsx)(h.Z,{values:M[de.office.address.country.toLowerCase()],inline:Ze,name:"state",type:"text",hasFilter:!0,label:"ca"===de.office.address.country.toLowerCase()?"Province":"State",value:M[de.office.address.country.toLowerCase()].find((function(e){return e.id===de.office.address.state}))||M[de.office.address.country.toLowerCase()][0],onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{state:e.id})})}))}}):(0,c.jsx)(v.Z,{name:"state",type:"text",label:"ca"===de.office.address.country.toLowerCase()?"Province":"State",value:de.office.address.state,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{state:e})})}))}})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,c.jsx)(v.Z,{name:"city",type:"text",label:"City",value:de.office.address.city,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{city:e})})}))}}),(0,c.jsx)(v.Z,{name:"postalCode",type:"text",label:"us"!==de.office.address.country.toLowerCase()?"Postal code":"ZIP code",value:de.office.address.postalCode,onChange:function(e){return re((0,t.Z)((0,a.Z)({},de),{office:(0,t.Z)((0,a.Z)({},de.office),{address:(0,t.Z)((0,a.Z)({},de.office.address),{postalCode:e})})}))}})]})]})]})]})]})]})}I.auth=!0},51351:function(e,n,i){"use strict";function s(e){throw e}i.d(n,{Z:function(){return s}})}},function(e){e.O(0,[9774,2888,179],(function(){return n=79755,e(e.s=n);var n}));var n=e.O();_N_E=n}]);